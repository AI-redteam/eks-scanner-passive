# EKS Scout - Narrative Report Generator

## Purpose

This supplementary script analyzes the **original** CSV output generated by the `eks_scout.py` scanner. It identifies specific resources (primarily Pods) that have dangerous **combinations** of security misconfigurations reported.

Instead of just listing individual findings, this tool generates a Markdown narrative report that:

1.  Highlights Pods with high-risk combinations (e.g., Privileged + HostPath, Root User + Host Network).
2.  Explains the potential **impact** of these chained threats (e.g., container escape, privilege escalation, lateral movement).
3.  Helps prioritize remediation efforts by focusing on the most critically misconfigured resources.
4.  Provides clearer communication to stakeholders about cumulative risk.

## Prerequisites

* Python 3.x
* The **original CSV findings file** generated by `eks_scout.py` (do **not** use the output from the roll-up script as input here).

## Usage

1.  Save the script (e.g., `generate_narrative.py`).
2.  Run the script from your command line, providing the input and output file paths:

    ```bash
    python generate_narrative.py -i <input_csv_file> -o <output_markdown_file>
    ```

    **Arguments:**

    * `-i INPUT_CSV`, `--input INPUT_CSV`: **Required**. Path to the original EKS Scout CSV findings file.
    * `-o OUTPUT_MD`, `--output OUTPUT_MD`: **Required**. Path where the output Markdown narrative report will be saved.

    **Example:**

    ```bash
    # Read findings from eks_scout_output.csv and write report to high_risk_report.md
    python generate_narrative.py -i eks_scout_output.csv -o high_risk_report.md
    ```

3.  Review the generated Markdown file (`high_risk_report.md` in the example) for the analysis of high-risk resource combinations.
