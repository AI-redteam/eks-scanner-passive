# EKS Scout Findings Roll-up Script

This Python script processes a CSV output file generated by the EKS Scout security scanner. Its purpose is to de-duplicate and "roll-up" similar findings (especially those related to replicated pods/containers stemming from common templates) into single, more concise entries while listing all original affected components within the description. This helps in generating cleaner reports for tools like Plextrac.

## Prerequisites

* Python 3.x
* An input CSV file generated by the EKS Scout tool.

## How to Use

1.  **Save the script:** Save the script as `rollup_eks_findings.py` (or your preferred name).
2.  **Run from the command line:**

    ```bash
    python rollup_eks_findings.py -i <input_csv_file> -o <output_csv_file>
    ```

    **Arguments:**

    * `-i INPUT_FILE`, `--input INPUT_FILE`: **Required**. Path to the input CSV file generated by the EKS Scout tool.
    * `-o OUTPUT_FILE`, `--output OUTPUT_FILE`: **Required**. Path for the new CSV file where the rolled-up findings will be saved.

    **Example:**

    ```bash
    python rollup_eks_findings.py -i ./eks_scout_output.csv -o ./rolled_up_findings.csv
    ```

    This command will read `eks_scout_output.csv`, process the findings, and write the consolidated results to `rolled_up_findings.csv`.

## Functionality

The script groups findings based on common attributes like `Finding Name`, `Severity`, `Recommendation`, `Namespace`, and for pod/container related issues, an inferred `controller/workload name` and `container name`.

For each group of similar findings:
* A single "rolled-up" finding is created.
* The `Description` field of the rolled-up finding is updated to list all the original affected components and their specific details.
* The main `Affected Components` field is generalized to point to the common source or scope (e.g., a workload or namespace).
* Tags are updated to reflect the roll-up.
